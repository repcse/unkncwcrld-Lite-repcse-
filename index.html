<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><title>unkncwcrld</title>
<style>
html,body{margin:0;padding:0;height:100%;font-family:Arial,sans-serif;overflow-y:auto;background:#fafafa;color:#222}
#app{width:450px;min-height:100vh;margin:auto;padding:10px}
a{color:#0066cc;text-decoration:none;margin:0 5px}a:hover{text-decoration:underline}
h3,h4,h5{margin:10px 0 5px 0}hr{border:none;border-top:1px solid #ccc;margin:10px 0}
#footer{height:150px;overflow:auto;padding:4px;background:#fff}
</style></head><body>
<div id="app">
<h3>repcse</h3><div id="clock"></div><div id="notice">Welcome! Register to become a citizen.</div><hr/>
<div id="registerArea">
<a href="#" id="registerBtn">Register as Citizen</a> |
<a href="#" id="loadExistBtn">Load as Existing Citizen</a>
<input type="file" id="loadExistFile" style="display:none" accept=".txt"/>
</div>
<div id="citizenArea" hidden>
<div id="status"></div>
<div id="menulink" style="margin-top:10px;">
<b>Menulink</b><br/>
<a href="#" data-action="jobs">Job</a> |
<a href="#" data-action="activity">Activity</a> |
<a href="#" data-action="education">Education</a> |
<a href="#" data-action="bank">Bank</a> |
<a href="#" data-action="settings">Settings</a>
</div>
<div id="mainPanel" style="margin-top:10px;"></div>
</div><hr/>
<div><b>Log</b> (latest on top)</div><div id="footer"></div>
</div>
<script src="jobs.js"></script>
<script>
(function(){
const state={registered:false,id:'',money:50,job:null,taxRate:0.10,lastWork:null,birth:null,educationLevel:0,educationStart:null,educationFinish:null,lastTaxChange:null,bankBalance:0,bankLastInterest:null,loanAmount:0,bankLog:[]};
function $(id){return document.getElementById(id);}
function saveLocal(){localStorage.setItem('repcse_st',JSON.stringify(state));}
function loadLocal(){const raw=localStorage.getItem('repcse_st');if(raw){try{Object.assign(state,JSON.parse(raw));}catch(e){}}}
function formatMoney(v){return v.toFixed(2);}
function log(msg){const now=new Date();const entry=document.createElement('div');entry.textContent=`[${now.toLocaleString('en-GB',{hour12:false})}] ${msg}`;$('footer').prepend(entry);}
function escapeHtml(s){return String(s).replace(/[&<>\"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));}
function randID(){const chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';let id='';for(let i=0;i<7;i++)id+=chars[Math.floor(Math.random()*chars.length)];return id;}
function updateTaxRateIfNeeded(){const now=new Date();const last=state.lastTaxChange?new Date(state.lastTaxChange):null;const sevenDays=7*24*3600*1000;if(!last||now-last>=sevenDays){const newRate=+(0.07+Math.random()*(0.28-0.07)).toFixed(3);state.taxRate=newRate;state.lastTaxChange=now.toISOString();saveLocal();log(`ðŸ“Š New tax rate applied: ${(newRate*100).toFixed(1)}%`);}}
function updateBankInterest(){if(state.bankBalance<=0)return;const now=new Date();const last=state.bankLastInterest?new Date(state.bankLastInterest):null;if(!last||now-last>=86400000){const rate=+(0.001+Math.random()*(0.003-0.001)).toFixed(4);const gain=+(state.bankBalance*rate).toFixed(2);state.bankBalance=+(state.bankBalance+gain).toFixed(2);state.bankLastInterest=now.toISOString();state.bankLog.unshift(`Interest +${formatMoney(gain)} (${(rate*100).toFixed(2)}%)`);saveLocal();log(`ðŸ’° Bank interest added: +${formatMoney(gain)} cr (${(rate*100).toFixed(2)}%)`);}}
function renderStatus(){if(!state.registered){$('notice').textContent='Not registered yet.';$('citizenArea').hidden=true;$('registerArea').hidden=false;return;}
$('notice').textContent='You are a citizen.';$('registerArea').hidden=true;$('citizenArea').hidden=false;
const nextWorkTime=getNextWorkTime();const jobInfo=state.job?state.job.title:'-';const cooldownInfo=state.lastWork&&nextWorkTime?`<br/>Next work available: ${nextWorkTime.toLocaleString('en-GB',{hour12:false})}`:'';const birth=new Date(state.birth);const days=Math.floor((Date.now()-birth.getTime())/86400000);const eduBonus=state.educationLevel;const eduFinish=state.educationFinish?new Date(state.educationFinish).toLocaleString('en-GB',{hour12:false}):'-';const lastTax=state.lastTaxChange?new Date(state.lastTaxChange).toLocaleString('en-GB',{hour12:false}):'-';let currentSalary=0,netSalary=0;if(state.job){currentSalary=+(state.job.wage*(1+eduBonus/100)).toFixed(2);netSalary=+(currentSalary*(1-state.taxRate)).toFixed(2);}
$('status').innerHTML=`<h4>Citizen Status</h4>
ID: ${state.id}<br/>Birth: ${birth.toLocaleString('en-GB',{hour12:false})}<br/>
Days: ${days}<br/>Money: ${formatMoney(state.money)} cr<br/>Job: ${jobInfo}<br/>
${state.job?`Current Salary: ${formatMoney(currentSalary)} cr<br/>Net Salary (after tax): ${formatMoney(netSalary)} cr<br/>`:''}
Education Level: ${state.educationLevel}<br/>Education Bonus: ${eduBonus}%<br/>
Tax Rate: ${(state.taxRate*100).toFixed(1)}%<br/>Last Tax Change: ${lastTax}<br/>
Bank Balance: ${formatMoney(state.bankBalance)} cr<br/>Loan: ${formatMoney(state.loanAmount)} cr<br/>
Education Finish on: ${eduFinish}${cooldownInfo}`;}
function register(){const now=new Date();const randomTax=+(0.07+Math.random()*(0.28-0.07)).toFixed(3);Object.assign(state,{registered:true,id:randID(),money:50,job:null,taxRate:randomTax,lastWork:null,birth:now.toISOString(),educationLevel:0,educationStart:null,educationFinish:null,lastTaxChange:now.toISOString(),bankBalance:0,bankLastInterest:null,loanAmount:0,bankLog:[]});saveLocal();renderStatus();log(`Citizen ${state.id} registered with tax ${(randomTax*100).toFixed(1)}%.`);}
function loadFromFile(file){const reader=new FileReader();reader.onload=()=>{try{Object.assign(state,JSON.parse(reader.result));saveLocal();renderStatus();log(`Citizen ${state.id} loaded from file.`);}catch(e){alert('Invalid file format.');}};reader.readAsText(file);}
function showJobs(){const jobList=window.jobsList||[];const p=$('mainPanel');p.innerHTML='<h5>Available Jobs</h5>';jobList.forEach(j=>{const a=document.createElement('a');const days=j.days.map(d=>['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][d]).join(', ');a.href='#';a.textContent=`${j.title} â€” Wage: ${formatMoney(j.wage)}/day (Days: ${days})`;a.onclick=e=>{e.preventDefault();applyJob(j.id);};p.appendChild(a);p.appendChild(document.createElement('br'));});}
function applyJob(id){if(state.job)return log('You already have a job. Resign first.');const j=(window.jobsList||[]).find(x=>x.id===id);if(!j)return;state.job={...j};saveLocal();renderStatus();$('mainPanel').innerHTML=`<div>You are now employed as ${j.title}.</div>`;log(`Got job: ${j.title}.`);}
function resignJob(){if(!state.job)return log('No job to resign from.');log(`Resigned from job: ${state.job.title}.`);state.job=null;saveLocal();renderStatus();}
function canWorkToday(job){return job.days.includes(new Date().getDay());}
function getNextWorkTime(){if(!state.lastWork)return null;return new Date(new Date(state.lastWork).getTime()+86400000);}
function workDay(){if(!state.job)return log('No job.');if(!canWorkToday(state.job))return log(`You cannot work today.`);const now=new Date();if(state.lastWork){const next=getNextWorkTime();if(now<next)return log(`You already worked today. Next: ${next.toLocaleString('en-GB',{hour12:false})}`);}checkEducationProgress();const gross=state.job.wage*(1+state.educationLevel/100);const tax=+(gross*state.taxRate).toFixed(2);const net=+(gross-tax).toFixed(2);state.money=+(state.money+net).toFixed(2);state.lastWork=now.toISOString();saveLocal();renderStatus();log(`Worked as ${state.job.title}. Earned ${formatMoney(net)} (Tax ${formatMoney(tax)}).`);}
function showActivity(){const p=$('mainPanel');p.innerHTML=`<h5>Activity</h5><a href="#" id="workBtn">Work</a><br/><a href="#" id="resignBtn">Resign</a>`;$('workBtn').onclick=e=>{e.preventDefault();workDay();};$('resignBtn').onclick=e=>{e.preventDefault();resignJob();};}
function showEducation(){const p=$('mainPanel');const level=state.educationLevel+1;const cost=30*level;let html='<h5>Education</h5>';if(state.educationFinish){html+=`<div>Currently enrolled in Level ${level}.<br/>Finishes on: ${new Date(state.educationFinish).toLocaleString('en-GB',{hour12:false})}<br/><a href="#" id="dropout">Dropout</a></div>`;}else{html+=`<div>Next Level: ${level} (Cost: ${formatMoney(cost)} cr)<br/><a href="#" id="enroll">Enroll</a></div>`;}p.innerHTML=html;if($('enroll'))$('enroll').onclick=e=>{e.preventDefault();enrollEducation();};if($('dropout'))$('dropout').onclick=e=>{e.preventDefault();dropoutEducation();};}
function enrollEducation(){const nextLevel=state.educationLevel+1;if(nextLevel>100)return log('Max education level reached.');const cost=30*nextLevel;if(state.money<cost)return log('Not enough money.');const now=new Date();state.money-=cost;state.educationStart=now.toISOString();state.educationFinish=new Date(now.getTime()+3*24*3600*1000).toISOString();saveLocal();renderStatus();log(`Enrolled Level ${nextLevel}.`);showEducation();}
function dropoutEducation(){state.educationStart=null;state.educationFinish=null;saveLocal();renderStatus();log('Dropped out.');showEducation();}
function checkEducationProgress(){if(!state.educationFinish)return;const now=new Date();if(now>=new Date(state.educationFinish)){state.educationLevel++;log(`Completed Education Level ${state.educationLevel}!`);state.educationStart=null;state.educationFinish=null;saveLocal();renderStatus();}}
function showBank(){const p=$('mainPanel');let html=`<h5>Bank</h5>
Balance: ${formatMoney(state.bankBalance)} cr<br/>Loan: ${formatMoney(state.loanAmount)} cr<br/><br/>
Deposit: <input id="depAmt" type="number" min="0" style="width:80px"/> <a href="#" id="depBtn">Deposit</a><br/>
Withdraw: <input id="witAmt" type="number" min="0" style="width:80px"/> <a href="#" id="witBtn">Withdraw</a><br/>
Loan: <input id="loanAmt" type="number" min="0" style="width:80px"/> <a href="#" id="loanBtn">Take Loan</a><br/>
<a href="#" id="repayBtn">Repay Loan</a><br/><br/><b>Bank Statement</b><div id="bankLog" style="max-height:120px;overflow:auto;border-top:1px solid #ccc;">${state.bankLog.map(l=>`<div>${l}</div>`).join('')||'(empty)'}</div>`;p.innerHTML=html;
$('depBtn').onclick=e=>{e.preventDefault();let amt=+$('depAmt').value;if(amt<=0)return;if(state.money<amt)return log('Not enough money.');state.money-=amt;state.bankBalance+=amt;state.bankLog.unshift(`Deposited ${formatMoney(amt)} cr`);saveLocal();renderStatus();showBank();};
$('witBtn').onclick=e=>{e.preventDefault();let amt=+$('witAmt').value;if(amt<=0)return;if(state.bankBalance<amt)return log('Not enough balance.');state.bankBalance-=amt;state.money+=amt;state.bankLog.unshift(`Withdrew ${formatMoney(amt)} cr`);saveLocal();renderStatus();showBank();};
$('loanBtn').onclick=e=>{e.preventDefault();let amt=+$('loanAmt').value;if(amt<=0)return;const interest=+(amt*0.05).toFixed(2);state.loanAmount+=amt+interest;state.money+=amt;state.bankLog.unshift(`Loan ${formatMoney(amt)} + interest ${formatMoney(interest)}`);saveLocal();renderStatus();showBank();};
$('repayBtn').onclick=e=>{e.preventDefault();if(state.loanAmount<=0)return log('No loan to repay.');if(state.money<state.loanAmount)return log('Not enough money.');state.money-=state.loanAmount;state.bankLog.unshift(`Repaid ${formatMoney(state.loanAmount)} cr`);state.loanAmount=0;saveLocal();renderStatus();showBank();};}
function showSettings(){const p=$('mainPanel');p.innerHTML=`<h5>Settings</h5>
<a href="#" id="saveBtn">Save to File</a><br/>
<a href="#" id="loadBtn">Load from File</a><input type="file" id="loadFile" style="display:none" accept=".txt"/><br/>
<a href="#" id="resetBtn">Reset All Data</a><br/>
<a href="#" id="clearBankBtn">Reset Bank Statement</a>`;
$('saveBtn').onclick=e=>{e.preventDefault();if(!confirm('Save current data to file?'))return;const blob=new Blob([JSON.stringify(state,null,2)],{type:'text/plain'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`repcse_${state.id}.txt`;a.click();URL.revokeObjectURL(url);};
$('loadBtn').onclick=e=>{e.preventDefault();$('loadFile').click();};
$('loadFile').onchange=e=>{const file=e.target.files[0];if(!file)return;loadFromFile(file);};
$('resetBtn').onclick=e=>{e.preventDefault();if(!confirm('Reset ALL data?'))return;localStorage.removeItem('repcse_st');location.reload();};
$('clearBankBtn').onclick=e=>{e.preventDefault();if(!confirm('Clear bank statement?'))return;state.bankLog=[];saveLocal();showSettings();log('Bank statement cleared.');};}
// === EVENTS ===
document.addEventListener('click',e=>{const el=e.target.closest('a[data-action]');if(!el)return;e.preventDefault();const act=el.dataset.action;if(act==='jobs')showJobs();else if(act==='activity')showActivity();else if(act==='education')showEducation();else if(act==='bank')showBank();else if(act==='settings')showSettings();});
$('registerBtn').onclick=e=>{e.preventDefault();register();};
$('loadExistBtn').onclick=e=>{e.preventDefault();$('loadExistFile').click();};
$('loadExistFile').onchange=e=>{const file=e.target.files[0];if(!file)return;loadFromFile(file);};
// === MAIN LOOP ===
setInterval(()=>{const now=new Date();$('clock').textContent=now.toLocaleString('en-GB',{hour12:false});if(state.registered){updateTaxRateIfNeeded();updateBankInterest();checkEducationProgress();}},1000);
loadLocal();if(state.registered){updateTaxRateIfNeeded();updateBankInterest();}renderStatus();log('Demo loaded v004.');
})();
</script></body></html>